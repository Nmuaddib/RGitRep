#### Histograma para SADT e modelo pelo GGPlot2 -------------
ggplot(cai_SCc,aes(sadt)) +
stat_bin(aes(y =..density..,
fill = ..count..),
col = "black",
binwidth = 35000,
alpha = 0.8) +
geom_density(fill = "red",
color = "orange",
alpha = 0.11) +
scale_x_continuous(breaks = seq(200000, 800000, by = 100000)) +
scale_y_continuous(labels = NULL) +
labs(title = 'Histograma de SADT', x = 'SADT', y = 'Contagem') +
scale_fill_distiller(name = 'Observações',
palette = 'YlGnBu',
direction = 1)
ggplot(cai_SCc,aes(predT)) +
stat_bin(aes(y =..density..,
fill = ..count..),
col = "black",
binwidth = 35000,
alpha = 0.8) +
geom_density(fill = "red",
color = "blue",
alpha = 0.11) +
scale_x_continuous(breaks = seq(200000, 800000, by = 100000)) +
scale_y_continuous(labels = NULL) +
labs(title = 'Histograma de SADT Previsto pelo modelo', x = 'SADT Previsto', y = 'Contagem') +
scale_fill_distiller(name = 'Observações',
palette = 'YlGn',
direction = 1)
#### Gráfico de Controle Estatístico de Processo ------------
qcc.cai_SCc <- qcc(cai_SCc$sadt, type = 'xbar.one', newdata = fitted(lmT.SCc));qcc.cai_SCc
#### Histograma e densidade com alvos para capacidade -------
process.capability (qcc.cai_SCc, spec.limits=c(400000,700000))
#### Importação de dados e inclusão de coluna ---------------
rec_des <- read_excel('Gráfico e Previsão 2017 2.xlsx') %>%
add_column(Diff = .$Despesa - .$Receita) %>%
as.tibble()
#### Gráfico base -------------------------------------------
GGrec_des <- ggplot(data = rec_des, aes(x = Ano)) + # Dados básicos e eixos comuns
# Barras de despesa
geom_col(aes(y = Despesa/1000000, fill = Diff/1000000),
width = 0.9,
alpha=0.4,
#stat = "sum",
col = "black",
size = 1) +
# Efeito gradiente para qualquer preenchimento usado na estética do gráfico
scale_fill_gradient(name="Delta entre Despesa\ne Receita em Mil, 2011 - 2017",
low = "green",
high = "red",
space = "Lab",
guide = "colourbar") +
# Controle da quebra da escala no eixo X
scale_x_continuous(breaks = seq(2011, 2017, by = 1)) +
# Tema geral da área do gráfico
theme_light() +
# Mudança de orientação do texto da legenda do eixo x
theme(axis.text.x = element_text(angle = 45,
vjust = 1,
size = 9,
hjust = 1)) +
# Textos de eixos e Título
labs(title = 'Média Mensal de Despesa X Receita', x = 'Anos', y = 'Despesa/Receita');GGrec_des
#### Gráfico com adição de camada com coluna de receita -----
GGrec_des +
# Controle da quebra da escala no eixo y
scale_y_continuous(breaks = seq(50, 180, by = 10)) +
# Barras de receita
geom_bar(aes(y = Receita/1000000),
width = 0.5, alpha=0.3,
fill = "blue",
stat = "sum",
size = 1)
#### Gráfico com adição de camada com área de receita -------
GGrec_des +
# Área de receita
geom_area(aes(y = Receita/1000000),
col = "blue",
size = 0.2,
alpha = 0.3) +
# Pontos para marcação da receita sobre a área
geom_point(aes(y = Receita/1000000, col = Diff/1000000),
size=3.8, shape=21, fill="white") +
# Texto com valores
geom_text(aes(y = (Despesa/1000000) + 13,
label = format((Diff/1000000), digits = 2),
col = Diff/1000000),
size = 4) +
# Efeito gradiente para qualquer cor usada na estética do gráfico
scale_colour_gradient(name="Valor do Delta\nem Mil, 2011 - 2017",
low = "blue",
high = "orange",
space = "Lab",
guide = "colourbar") +
# Controle da quebra da escala no eixo y
scale_y_continuous(breaks = seq(50, 180, by = 10)) +
# Zoom no eixo y
coord_cartesian(ylim=c(45,150))
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth() +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red') +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = lm.cai_SCc) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "lm.cai_SCc") +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "lm") +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "lm", alpha = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "lm", alpha = 0.2) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "lm", alpha = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 2) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 2, size = 1) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 2, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 3, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 4, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 5, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 6, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.5, linetype = 3, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.2, linetype = 3, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
#geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'red', method = "loess", alpha = 0.2, linetype = 3, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
ggplot(SCc.CI[25:65,], aes(x = rn, y = fit, col = fit)) +
geom_point(size = 2) +
geom_errorbar(aes(ymax = upr, ymin = lwr)) +
#geom_line(color = "light blue", size = 0.4, alpha = 0.5) +
geom_point(data = cai_SCc[25:65,], aes(y = sadt),col = "red" , size = 1.5) +
theme_dark() +
geom_smooth(col = 'white', method = "loess", alpha = 0.2, linetype = 3, size = 0.5) +
scale_colour_gradient2(name="Variação em\ntorno da média",
low = "white",
mid = "orange",
midpoint = 591713,
high = "white") +
labs(title = 'Amostra de assertividade nas previsões',
x = 'Observações', y = 'Valor Previsto')
class(sum)
attributes(sum)
attributes(print)
class(print)
primitive(sum)
.primitive(sum)
.Primitive("sum")
.Primitive("print")
class(mutate)
attributes(mutate)
.Primitive("mutate")
attributes("mutate")
??srcref
attr(mutate, "srcref")
attr(print, "srcref")
attr(f.cor_plot(), "srcref")
attr(f.cor_plot, "srcref")
attributes(f.cor_plot, "srcref")
attr(f.cor_plot, "srcref")
body(mutate)
body(UseMethod)
.Primitive("UseMethod")
sum
objs <- mget(ls("package:base"), inherits = TRUE)
funs <- Filter(is.function, objs)
str(funs)
funs
funs$abbreviate
str(funs$abbreviate)
names(funs$abbreviate)
attributes(funs$abbreviate)
formals((funs$abbreviate))
formals(length(funs$abbreviate))
formals(len(funs$abbreviate))
lenght(formals(funs$abbreviate))
len(formals(funs$abbreviate))
length(formals(funs$abbreviate))
siz <- length(formals(funs$.))
siz <- length(lapply(funs, formals))
siz <- lapply(lapply(funs, formals), lenght)
siz <- lapply(lapply(funs, formals), length)
siz
max(siz)
max(siz[[]])
max(siz[[1]])
siz[[1]]
siz[1]
siz[1,1]
siz[[1]]
siz <- lapply(lapply(lapply(funs, formals), length), "[[")
siz <- lapply(lapply(lapply(funs, formals), length), "[[", 1)
siz
siz <- lapply(lapply(funs, formals), length)
siz
siz[[1]]
siz[[2]]
siz <- lapply(lapply(funs, formals), length)
for (i in seq_along(siz)) {
lenV[i] <- lapply(siz, "[[", i)
}
siz <- lapply(lapply(funs, formals), length)
lenV <- double()
for (i in seq_along(siz)) {
lenV[i] <- lapply(siz, "[[", i)
}
seq_along(siz)
siz <- lapply(lapply(funs, formals), length)
lenV <- vector()
for (i in seq_along(siz)) {
lenV[i] <- lapply(siz, "[[", i)
}
for (i in seq_along(siz)) {
print(lapply(siz, "[[", i))
}
lapply(siz, "[[", 1)
lapply(siz, [[, 1)
siz[[2]]
lappl
siz <- lapply(lapply(funs, formals), length)
lenV <- vector()
for (i in seq_along(siz)) {
print(lapply(siz, [[, i))
}
max(siz[[1]])
seq_along(siz)
lapply(siz, [[, 1)
siz[[2]]
lappl
lapply(siz, '[[', 1)
lapply(siz, [[, 1)
siz[[2]]
lappl
lapply(siz, [[, 1)
siz[[2]]
lappl
map(siz, [[, 1)
siz[[2]]
lappl
map(siz, [[, 1)
map(siz, '[[', 1)
siz[['[[']]
funs[['[[']]
funs$'[['
funs['[[']
siz <- lapply(lapply(funs, formals), length)
lenV <- vector()
for (i in seq_along(siz)) {
lenV <- siz[[i]]
}
max(lenV)
lenV
siz <- lapply(lapply(funs, formals), length)
siz <- lapply(lapply(funs, formals), length)
lenV <- vector()
for (i in seq_along(siz)) {
lenV[i] <- siz[[i]]
}
max(lenV)
lenV
